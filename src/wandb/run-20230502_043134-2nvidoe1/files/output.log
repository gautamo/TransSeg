
Validation sanity check:   0% 0/2 [00:00<?, ?it/s]
  | Name      | Type          | Params
--------------------------------------------
0 | encoder   | BEiT3D        | 85.8 M
1 | decoder   | UPerHead      | 74.9 M
2 | criterion | DiceFocalLoss | 0
--------------------------------------------
160 M     Trainable params
0         Non-trainable params
160 M     Total params
643.098   Total estimated model params size (MB)
/usr/local/lib/python3.8/site-packages/torch/nn/functional.py:3060: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn("Default upsampling behavior when mode={} is changed "
/gdrive/MyDrive/TransSeg/src/utils.py:317: RuntimeWarning: invalid value encountered in true_divide
  acc = total_area_intersect / total_area_label
/gdrive/MyDrive/TransSeg/src/utils.py:321: RuntimeWarning: invalid value encountered in true_divide
  iou = total_area_intersect / total_area_union
/gdrive/MyDrive/TransSeg/src/utils.py:324: RuntimeWarning: invalid value encountered in true_divide
  dice = 2 * total_area_intersect / (total_area_pred_label + total_area_label)
Validation sanity check:   0% 0/2 [00:00<?, ?it/s][ 0. nan nan  0.  0.  0.  0.  0.]







Epoch 0:   7% 140/1889 [04:09<51:40,  1.77s/it, loss=0.95, v_num=doe1]
/usr/local/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py:1051: UserWarning: Detected KeyboardInterrupt, attempting graceful shutdown...
Epoch 0:   7% 140/1889 [04:09<51:40,  1.77s/it, loss=0.95, v_num=doe1] GB: END trainer.fit(model, datamodule=dm)
GB: START trainer.validate(datamodule=dm)
Traceback (most recent call last):
  File "main.py", line 178, in <module>
    train(args)
  File "main.py", line 129, in train
    trainer.validate(datamodule=dm)
  File "/usr/local/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 624, in validate
    self.validated_ckpt_path = self.__load_ckpt_weights(ckpt_path)
  File "/usr/local/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1151, in __load_ckpt_weights
    raise MisconfigurationException(
pytorch_lightning.utilities.exceptions.MisconfigurationException: `.validate(ckpt_path="best")` is set but `ModelCheckpoint` is not configured to save the best model.